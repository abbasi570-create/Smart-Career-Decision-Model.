# train_model.py
import pandas as pd
import numpy as np
import joblib
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import LabelEncoder

# -------------------------
# Create synthetic dataset (logical & balanced)
# -------------------------
np.random.seed(42)

careers = ["Doctor", "Engineer", "Business Analyst", "Artist", "Researcher"]
rows = []

for _ in range(800):   # LARGE dataset ✔
    career = np.random.choice(careers)

    if career == "Doctor":
        row = {
            "Math": np.random.randint(60, 90),
            "Science": np.random.randint(80, 100),
            "Biology": np.random.randint(85, 100),
            "Tech_Interest": np.random.randint(2, 6),
            "Med_Interest": np.random.randint(7, 10),
            "Business_Interest": np.random.randint(1, 4),
            "Creativity": np.random.randint(3, 6),
            "Logical": np.random.randint(6, 9),
            "Career": career
        }

    elif career == "Engineer":
        row = {
            "Math": np.random.randint(80, 100),
            "Science": np.random.randint(70, 95),
            "Biology": np.random.randint(40, 65),
            "Tech_Interest": np.random.randint(7, 10),
            "Med_Interest": np.random.randint(1, 4),
            "Business_Interest": np.random.randint(3, 6),
            "Creativity": np.random.randint(5, 8),
            "Logical": np.random.randint(7, 10),
            "Career": career
        }

    elif career == "Business Analyst":
        row = {
            "Math": np.random.randint(65, 90),
            "Science": np.random.randint(50, 75),
            "Biology": np.random.randint(40, 60),
            "Tech_Interest": np.random.randint(4, 7),
            "Med_Interest": np.random.randint(1, 3),
            "Business_Interest": np.random.randint(7, 10),
            "Creativity": np.random.randint(5, 8),
            "Logical": np.random.randint(7, 10),
            "Career": career
        }

    elif career == "Artist":
        row = {
            "Math": np.random.randint(30, 55),
            "Science": np.random.randint(30, 55),
            "Biology": np.random.randint(30, 55),
            "Tech_Interest": np.random.randint(3, 6),
            "Med_Interest": np.random.randint(1, 3),
            "Business_Interest": np.random.randint(3, 6),
            "Creativity": np.random.randint(8, 10),
            "Logical": np.random.randint(3, 6),
            "Career": career
        }

    else:  # Researcher
        row = {
            "Math": np.random.randint(65, 90),
            "Science": np.random.randint(75, 95),
            "Biology": np.random.randint(60, 85),
            "Tech_Interest": np.random.randint(4, 7),
            "Med_Interest": np.random.randint(4, 7),
            "Business_Interest": np.random.randint(1, 3),
            "Creativity": np.random.randint(5, 7),
            "Logical": np.random.randint(8, 10),
            "Career": career
        }

    rows.append(row)

df = pd.DataFrame(rows)

# -------------------------
# Encode target
# -------------------------
le = LabelEncoder()
df["Career"] = le.fit_transform(df["Career"])

X = df.drop("Career", axis=1)
y = df["Career"]

# -------------------------
# Train model
# -------------------------
model = RandomForestClassifier(
    n_estimators=300,
    max_depth=10,
    random_state=42
)
model.fit(X, y)

# -------------------------
# Save files
# -------------------------
joblib.dump(model, "career_model.pkl")
joblib.dump(le, "career_label.pkl")

print("✅ Model trained & saved successfully")
